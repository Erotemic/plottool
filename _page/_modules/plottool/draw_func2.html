<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>plottool.draw_func2 &mdash; plottool 1.0.0.dev1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0.0.dev1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="plottool 1.0.0.dev1 documentation" href="../../index.html" />
    <link rel="up" title="plottool" href="../plottool.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">plottool 1.0.0.dev1 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li>
          <li><a href="../plottool.html" accesskey="U">plottool</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for plottool.draw_func2</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot; Lots of functions for drawing and plotting visiony things &quot;&quot;&quot;</span>
<span class="c"># TODO: New naming scheme</span>
<span class="c"># viz_&lt;funcname&gt; will clear everything. The current axes and fig: clf, cla.  # Will add annotations</span>
<span class="c"># interact_&lt;funcname&gt; will clear everything and start user interactions.</span>
<span class="c"># show_&lt;funcname&gt; will always clear the current axes, but not fig: cla # Might # add annotates?</span>
<span class="c"># plot_&lt;funcname&gt; will not clear the axes or figure. More useful for graphs</span>
<span class="c"># draw_&lt;funcname&gt; same as plot for now. More useful for images</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">six.moves</span> <span class="kn">import</span> <span class="nb">range</span><span class="p">,</span> <span class="nb">zip</span><span class="p">,</span> <span class="nb">map</span>
<span class="kn">import</span> <span class="nn">six</span>
<span class="c">#import os</span>
<span class="c">#import sys</span>
<span class="kn">import</span> <span class="nn">utool</span>
<span class="c"># Matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="kn">as</span> <span class="nn">mpl</span>
<span class="c"># Should be taken care of by parent</span>
<span class="c">#if not sys.platform.startswith(&#39;win32&#39;) and not sys.platform.startswith(&#39;darwin&#39;) and os.environ.get(&#39;DISPLAY&#39;, None) is None:</span>
<span class="c">#    # Write to files if we cannot display</span>
<span class="c">#    TARGET_BACKEND = &#39;PDF&#39;</span>
<span class="c">#else:</span>
<span class="c">#    TARGET_BACKEND = &#39;Qt4Agg&#39;</span>
<span class="c">#mpl.use(TARGET_BACKEND)</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.collections</span> <span class="kn">import</span> <span class="n">LineCollection</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">make_axes_locatable</span>
<span class="c"># Python</span>
<span class="kn">import</span> <span class="nn">colorsys</span>
<span class="kn">import</span> <span class="nn">pylab</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="c"># Qt</span>
<span class="c">#from __PYQT__ import QtCore, QtGui</span>
<span class="c">#from __PYQT__.QtCore import Qt</span>
<span class="c"># Scientific</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="c"># VTool</span>
<span class="kn">import</span> <span class="nn">vtool.patch</span> <span class="kn">as</span> <span class="nn">ptool</span>
<span class="kn">import</span> <span class="nn">vtool.image</span> <span class="kn">as</span> <span class="nn">gtool</span>
<span class="c"># Drawtool</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">mpl_keypoint</span> <span class="k">as</span> <span class="n">mpl_kp</span>
<span class="kn">from</span> <span class="nn">.custom_figure</span> <span class="kn">import</span> <span class="o">*</span>     <span class="c"># NOQA  # TODO: FIXME THIS FILE NEEDS TO BE PARTITIONED</span>
<span class="kn">from</span> <span class="nn">.custom_constants</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c"># NOQA  # TODO: FIXME THIS FILE NEEDS TO BE PARTITIONED</span>
<span class="kn">from</span> <span class="nn">.fig_presenter</span> <span class="kn">import</span> <span class="o">*</span>     <span class="c"># NOQA  # TODO: FIXME THIS FILE NEEDS TO BE PARTITIONED</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">color_funcs</span> <span class="k">as</span> <span class="n">color_fns</span>  <span class="c"># NOQA</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">custom_constants</span>  <span class="c"># NOQA</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">custom_figure</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">fig_presenter</span>

<span class="n">close_figure</span> <span class="o">=</span> <span class="n">fig_presenter</span><span class="o">.</span><span class="n">close_figure</span>
<span class="n">figure</span> <span class="o">=</span> <span class="n">custom_figure</span><span class="o">.</span><span class="n">figure</span>

<span class="n">lighten_rgb</span> <span class="o">=</span> <span class="n">color_fns</span><span class="o">.</span><span class="n">lighten_rgb</span>
<span class="n">to_base255</span> <span class="o">=</span> <span class="n">color_fns</span><span class="o">.</span><span class="n">to_base255</span>


<span class="p">(</span><span class="k">print</span><span class="p">,</span> <span class="n">print_</span><span class="p">,</span> <span class="n">printDBG</span><span class="p">,</span> <span class="n">rrr</span><span class="p">,</span> <span class="n">profile</span><span class="p">)</span> <span class="o">=</span> <span class="n">utool</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="n">__name__</span><span class="p">,</span> <span class="s">&#39;[df2]&#39;</span><span class="p">,</span> <span class="n">DEBUG</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c">#================</span>
<span class="c"># GLOBALS</span>
<span class="c">#================</span>

<span class="n">TMP_mevent</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">plotWidget</span> <span class="o">=</span> <span class="bp">None</span>


<div class="viewcode-block" id="get_pnum_func"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.get_pnum_func">[docs]</a><span class="k">def</span> <span class="nf">get_pnum_func</span><span class="p">(</span><span class="n">nRows</span><span class="p">,</span> <span class="n">nCols</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">offst</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">base</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">1</span>
    <span class="k">def</span> <span class="nf">pnum_</span><span class="p">(</span><span class="n">px</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">nRows</span><span class="p">,</span> <span class="n">nCols</span><span class="p">,</span> <span class="n">px</span> <span class="o">+</span> <span class="n">offst</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pnum_</span>

</div>
<div class="viewcode-block" id="kwargs_fnum"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.kwargs_fnum">[docs]</a><span class="k">def</span> <span class="nf">kwargs_fnum</span><span class="p">(</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">fnum</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;fnum&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fnum</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">fnum</span> <span class="o">=</span> <span class="n">next_fnum</span><span class="p">()</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;fnum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fnum</span>
    <span class="k">return</span> <span class="n">fnum</span>

</div>
<div class="viewcode-block" id="next_fnum"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.next_fnum">[docs]</a><span class="k">def</span> <span class="nf">next_fnum</span><span class="p">(</span><span class="n">new_base</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">base_fnum</span>
    <span class="k">if</span> <span class="n">new_base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">base_fnum</span> <span class="o">=</span> <span class="n">new_base</span>
    <span class="n">base_fnum</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">base_fnum</span>

</div>
<div class="viewcode-block" id="execstr_global"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.execstr_global">[docs]</a><span class="k">def</span> <span class="nf">execstr_global</span><span class="p">():</span>
    <span class="n">execstr</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;global&#39;</span> <span class="o">+</span> <span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
    <span class="k">return</span> <span class="n">execstr</span>

</div>
<div class="viewcode-block" id="distinct_colors"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.distinct_colors">[docs]</a><span class="k">def</span> <span class="nf">distinct_colors</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">brightness</span><span class="o">=.</span><span class="mi">878</span><span class="p">):</span>
    <span class="c"># http://blog.jianhuashao.com/2011/09/generate-n-distinct-colors.html</span>
    <span class="n">sat</span> <span class="o">=</span> <span class="n">brightness</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">brightness</span>
    <span class="n">HSV_tuples</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span> <span class="o">*</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">N</span><span class="p">,</span> <span class="n">sat</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">RGB_tuples</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">colorsys</span><span class="o">.</span><span class="n">hsv_to_rgb</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">HSV_tuples</span><span class="p">))</span>
    <span class="n">utool</span><span class="o">.</span><span class="n">deterministic_shuffle</span><span class="p">(</span><span class="n">RGB_tuples</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">RGB_tuples</span>

</div>
<div class="viewcode-block" id="add_alpha"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.add_alpha">[docs]</a><span class="k">def</span> <span class="nf">add_alpha</span><span class="p">(</span><span class="n">colors</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">]</span>

</div>
<span class="k">def</span> <span class="nf">_axis_xy_width_height</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">xaug</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">yaug</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">waug</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">haug</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="s">&#39;gets geometry of a subplot&#39;</span>
    <span class="n">autoAxis</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">()</span>
    <span class="n">xy</span>     <span class="o">=</span> <span class="p">(</span><span class="n">autoAxis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">xaug</span><span class="p">,</span> <span class="n">autoAxis</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">yaug</span><span class="p">)</span>
    <span class="n">width</span>  <span class="o">=</span> <span class="p">(</span><span class="n">autoAxis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">autoAxis</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">waug</span>
    <span class="n">height</span> <span class="o">=</span> <span class="p">(</span><span class="n">autoAxis</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">autoAxis</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">haug</span>
    <span class="k">return</span> <span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span>


<div class="viewcode-block" id="draw_border"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.draw_border">[docs]</a><span class="k">def</span> <span class="nf">draw_border</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">GREEN</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="s">&#39;draws rectangle border around a subplot&#39;</span>
    <span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">_axis_xy_width_height</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">-.</span><span class="mi">7</span><span class="p">,</span> <span class="o">-.</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">xoff</span><span class="p">,</span> <span class="n">yoff</span> <span class="o">=</span> <span class="n">offset</span>
        <span class="n">xy</span> <span class="o">=</span> <span class="p">[</span><span class="n">xoff</span><span class="p">,</span> <span class="n">yoff</span><span class="p">]</span>
        <span class="n">height</span> <span class="o">=</span> <span class="o">-</span> <span class="n">height</span> <span class="o">-</span> <span class="n">yoff</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="n">xoff</span>
    <span class="n">rect</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
    <span class="n">rect</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
    <span class="n">rect</span><span class="o">.</span><span class="n">set_clip_on</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">rect</span><span class="o">.</span><span class="n">set_fill</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">rect</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>


<span class="c"># TODO SEPARTE THIS INTO DRAW BBOX AND DRAW_ANNOTATION</span></div>
<div class="viewcode-block" id="draw_bbox"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.draw_bbox">[docs]</a><span class="k">def</span> <span class="nf">draw_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">lbl</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">bbox_color</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">lbl_bgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
              <span class="n">lbl_txtcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">draw_arrow</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="p">(</span><span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">rw</span><span class="p">,</span> <span class="n">rh</span><span class="p">)</span> <span class="o">=</span> <span class="n">bbox</span>
    <span class="c"># Transformations are specified in backwards order.</span>
    <span class="n">trans_annotation</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">Affine2D</span><span class="p">()</span>
    <span class="n">trans_annotation</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">rw</span><span class="p">,</span> <span class="n">rh</span><span class="p">)</span>
    <span class="n">trans_annotation</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">trans_annotation</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">rx</span> <span class="o">+</span> <span class="n">rw</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ry</span> <span class="o">+</span> <span class="n">rh</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">t_end</span> <span class="o">=</span> <span class="n">trans_annotation</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="o">-.</span><span class="mi">5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">t_end</span><span class="p">)</span>
    <span class="n">bbox</span><span class="o">.</span><span class="n">set_fill</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="c">#bbox.set_transform(trans)</span>
    <span class="n">bbox</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="n">bbox_color</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>
    <span class="c"># Draw overhead arrow indicating the top of the ANNOTATION</span>
    <span class="k">if</span> <span class="n">draw_arrow</span><span class="p">:</span>
        <span class="n">arw_xydxdy</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">arw_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">head_width</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">t_end</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">FancyArrow</span><span class="p">(</span><span class="o">*</span><span class="n">arw_xydxdy</span><span class="p">,</span> <span class="o">**</span><span class="n">arw_kw</span><span class="p">)</span>
        <span class="n">arrow</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="n">bbox_color</span><span class="p">)</span>
        <span class="n">arrow</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">bbox_color</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">arrow</span><span class="p">)</span>
    <span class="c"># Draw a label</span>
    <span class="k">if</span> <span class="n">lbl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ax_absolute_text</span><span class="p">(</span><span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">lbl</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                         <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                         <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
                         <span class="n">color</span><span class="o">=</span><span class="n">lbl_txtcolor</span><span class="p">,</span>
                         <span class="n">backgroundcolor</span><span class="o">=</span><span class="n">lbl_bgcolor</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="plot"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.plot">[docs]</a><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">yscale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;yscale&#39;</span><span class="p">,</span> <span class="s">&#39;linear&#39;</span><span class="p">)</span>
    <span class="n">xscale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;xscale&#39;</span><span class="p">,</span> <span class="s">&#39;linear&#39;</span><span class="p">)</span>
    <span class="n">logscale_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;logscale_kwargs&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;nonposx&#39;</span><span class="p">:</span> <span class="s">&#39;clip&#39;</span><span class="p">})</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="n">yscale_kwargs</span> <span class="o">=</span> <span class="n">logscale_kwargs</span> <span class="k">if</span> <span class="n">yscale</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;log&#39;</span><span class="p">,</span> <span class="s">&#39;symlog&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="p">{}</span>
    <span class="n">xscale_kwargs</span> <span class="o">=</span> <span class="n">logscale_kwargs</span> <span class="k">if</span> <span class="n">xscale</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;log&#39;</span><span class="p">,</span> <span class="s">&#39;symlog&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="p">{}</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">yscale</span><span class="p">,</span> <span class="o">**</span><span class="n">yscale_kwargs</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">xscale</span><span class="p">,</span> <span class="o">**</span><span class="n">xscale_kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">plot</span>

</div>
<div class="viewcode-block" id="plot2"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.plot2">[docs]</a><span class="k">def</span> <span class="nf">plot2</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">&#39;o&#39;</span><span class="p">,</span> <span class="n">title_pref</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span>
          <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">do_plot</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_data</span><span class="p">):</span>
        <span class="n">warnstr</span> <span class="o">=</span> <span class="s">&#39;[df2] ! Warning:  len(x_data) != len(y_data). Cannot plot2&#39;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">warnstr</span><span class="p">)</span>
        <span class="n">draw_text</span><span class="p">(</span><span class="n">warnstr</span><span class="p">)</span>
        <span class="n">do_plot</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">warnstr</span> <span class="o">=</span> <span class="s">&#39;[df2] ! Warning:  len(x_data) == 0. Cannot plot2&#39;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">warnstr</span><span class="p">)</span>
        <span class="n">draw_text</span><span class="p">(</span><span class="n">warnstr</span><span class="p">)</span>
        <span class="n">do_plot</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="n">do_plot</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">min_</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x_data</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">y_data</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
    <span class="n">max_</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_data</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">y_data</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="c"># Equal aspect ratio</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">min_</span><span class="p">,</span> <span class="n">max_</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">min_</span><span class="p">,</span> <span class="n">max_</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">FONTS</span><span class="o">.</span><span class="n">xlabel</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontproperties</span><span class="o">=</span><span class="n">FONTS</span><span class="o">.</span><span class="n">xlabel</span><span class="p">)</span>
    <span class="n">set_title</span><span class="p">(</span><span class="n">title_pref</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="n">x_label</span> <span class="o">+</span> <span class="s">&#39; vs &#39;</span> <span class="o">+</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="adjust_subplots_xlabels"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.adjust_subplots_xlabels">[docs]</a><span class="k">def</span> <span class="nf">adjust_subplots_xlabels</span><span class="p">():</span>
    <span class="n">adjust_subplots</span><span class="p">(</span><span class="n">left</span><span class="o">=.</span><span class="mo">03</span><span class="p">,</span> <span class="n">right</span><span class="o">=.</span><span class="mi">97</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span> <span class="n">top</span><span class="o">=.</span><span class="mi">9</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=.</span><span class="mi">15</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="adjust_subplots_xylabels"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.adjust_subplots_xylabels">[docs]</a><span class="k">def</span> <span class="nf">adjust_subplots_xylabels</span><span class="p">():</span>
    <span class="n">adjust_subplots</span><span class="p">(</span><span class="n">left</span><span class="o">=.</span><span class="mo">03</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span> <span class="n">top</span><span class="o">=.</span><span class="mi">9</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=.</span><span class="mi">15</span><span class="p">)</span>

</div>
<span class="n">SAFE_POS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;left&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span>
    <span class="s">&#39;right&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span>
    <span class="s">&#39;top&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span>
    <span class="s">&#39;bottom&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span>
    <span class="s">&#39;wspace&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">3</span><span class="p">,</span>
    <span class="s">&#39;hspace&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span>
<span class="p">}</span>


<div class="viewcode-block" id="adjust_subplots_safe"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.adjust_subplots_safe">[docs]</a><span class="k">def</span> <span class="nf">adjust_subplots_safe</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">six</span><span class="o">.</span><span class="n">iterkeys</span><span class="p">(</span><span class="n">SAFE_POS</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">SAFE_POS</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="n">adjust_subplots</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="adjust_subplots"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.adjust_subplots">[docs]</a><span class="k">def</span> <span class="nf">adjust_subplots</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>  <span class="n">bottom</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
                    <span class="n">right</span><span class="o">=</span><span class="mf">0.98</span><span class="p">,</span>     <span class="n">top</span><span class="o">=</span><span class="mf">0.90</span><span class="p">,</span>
                    <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>   <span class="n">hspace</span><span class="o">=</span><span class="mf">0.15</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    left  = 0.125  # the left side of the subplots of the figure</span>
<span class="sd">    right = 0.9    # the right side of the subplots of the figure</span>
<span class="sd">    bottom = 0.1   # the bottom of the subplots of the figure</span>
<span class="sd">    top = 0.9      # the top of the subplots of the figure</span>
<span class="sd">    wspace = 0.2   # the amount of width reserved for blank space between subplots</span>
<span class="sd">    hspace = 0.2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#print(&#39;[df2] adjust_subplots(%r)&#39; % locals())</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">wspace</span><span class="p">,</span> <span class="n">hspace</span><span class="p">)</span>


<span class="c">#=======================</span>
<span class="c"># TEXT FUNCTIONS</span>
<span class="c"># TODO: I have too many of these. Need to consolidate</span>
<span class="c">#=======================</span>

</div>
<div class="viewcode-block" id="upperleft_text"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.upperleft_text">[docs]</a><span class="k">def</span> <span class="nf">upperleft_text</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">txtargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">,</span>
                   <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;top&#39;</span><span class="p">,</span>
                   <span class="n">backgroundcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">),</span>
                   <span class="n">color</span><span class="o">=</span><span class="n">ORANGE</span> <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">color</span><span class="p">)</span>
    <span class="n">ax_relative_text</span><span class="p">(</span><span class="o">.</span><span class="mo">02</span><span class="p">,</span> <span class="o">.</span><span class="mo">02</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="o">**</span><span class="n">txtargs</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="upperright_text"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.upperright_text">[docs]</a><span class="k">def</span> <span class="nf">upperright_text</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">txtargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">,</span>
                   <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;top&#39;</span><span class="p">,</span>
                   <span class="n">backgroundcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">),</span>
                   <span class="n">color</span><span class="o">=</span><span class="n">ORANGE</span><span class="p">,</span>
                   <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
    <span class="n">ax_relative_text</span><span class="p">(</span><span class="o">.</span><span class="mi">98</span><span class="p">,</span> <span class="o">.</span><span class="mo">02</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="o">**</span><span class="n">txtargs</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="lowerright_text"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.lowerright_text">[docs]</a><span class="k">def</span> <span class="nf">lowerright_text</span><span class="p">(</span><span class="n">txt</span><span class="p">):</span>
    <span class="n">txtargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">,</span>
                   <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;bottom&#39;</span><span class="p">,</span>
                   <span class="n">backgroundcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">6</span><span class="p">),</span>
                   <span class="n">color</span><span class="o">=</span><span class="n">ORANGE</span><span class="p">)</span>
    <span class="n">ax_relative_text</span><span class="p">(</span><span class="o">.</span><span class="mi">98</span><span class="p">,</span> <span class="o">.</span><span class="mi">92</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="o">**</span><span class="n">txtargs</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="absolute_lbl"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.absolute_lbl">[docs]</a><span class="k">def</span> <span class="nf">absolute_lbl</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">y_</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="n">roffset</span><span class="o">=</span><span class="p">(</span><span class="o">-.</span><span class="mo">02</span><span class="p">,</span> <span class="o">-.</span><span class="mo">02</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">6</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; alternative to relative text &quot;&quot;&quot;</span>
    <span class="n">txtargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">,</span>
                   <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;top&#39;</span><span class="p">,</span>
                   <span class="n">backgroundcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">),</span>
                   <span class="n">color</span><span class="o">=</span><span class="n">ORANGE</span><span class="p">)</span>
    <span class="n">txtargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">ax_absolute_text</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">y_</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="n">roffset</span><span class="o">=</span><span class="n">roffset</span><span class="p">,</span> <span class="o">**</span><span class="n">txtargs</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="ax_relative_text"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.ax_relative_text">[docs]</a><span class="k">def</span> <span class="nf">ax_relative_text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">_axis_xy_width_height</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">x_</span><span class="p">,</span> <span class="n">y_</span> <span class="o">=</span> <span class="p">((</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">width</span><span class="p">,</span> <span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">height</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span> <span class="o">*</span> <span class="n">height</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">xoff</span><span class="p">,</span> <span class="n">yoff</span> <span class="o">=</span> <span class="n">offset</span>
        <span class="n">x_</span> <span class="o">+=</span> <span class="n">xoff</span>
        <span class="n">y_</span> <span class="o">+=</span> <span class="n">yoff</span>
    <span class="n">ax_absolute_text</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">y_</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="ax_absolute_text"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.ax_absolute_text">[docs]</a><span class="k">def</span> <span class="nf">ax_absolute_text</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">y_</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">roffset</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Base function for text &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="k">if</span> <span class="s">&#39;fontproperties&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;fontproperties&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FONTS</span><span class="o">.</span><span class="n">relative</span>
    <span class="k">if</span> <span class="n">roffset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">xroff</span><span class="p">,</span> <span class="n">yroff</span> <span class="o">=</span> <span class="n">roffset</span>
        <span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">_axis_xy_width_height</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">x_</span> <span class="o">+=</span> <span class="n">xroff</span> <span class="o">*</span> <span class="n">width</span>
        <span class="n">y_</span> <span class="o">+=</span> <span class="n">yroff</span> <span class="o">*</span> <span class="n">height</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">y_</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="fig_relative_text"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.fig_relative_text">[docs]</a><span class="k">def</span> <span class="nf">fig_relative_text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;horizontalalignment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;center&#39;</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;verticalalignment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;center&#39;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">gcf</span><span class="p">()</span>
    <span class="c">#xy, width, height = _axis_xy_width_height(ax)</span>
    <span class="c">#x_, y_ = ((xy[0]+width)+x*width, (xy[1]+height)-y*height)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">txt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="draw_text"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.draw_text">[docs]</a><span class="k">def</span> <span class="nf">draw_text</span><span class="p">(</span><span class="n">text_str</span><span class="p">,</span> <span class="n">rgb_textFG</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rgb_textBG</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">_axis_xy_width_height</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">text_x</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">text_y</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">text_x</span><span class="p">,</span> <span class="n">text_y</span><span class="p">,</span> <span class="n">text_str</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="s">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">rgb_textFG</span><span class="p">,</span>
            <span class="n">backgroundcolor</span><span class="o">=</span><span class="n">rgb_textBG</span><span class="p">)</span>


<span class="c">#def convert_keypress_event_mpl_to_qt4(mevent):</span>
<span class="c">#    global TMP_mevent</span>
<span class="c">#    TMP_mevent = mevent</span>
<span class="c">#    # Grab the key from the mpl.KeyPressEvent</span>
<span class="c">#    key = mevent.key</span>
<span class="c">#    print(&#39;[df2] convert event mpl -&gt; qt4&#39;)</span>
<span class="c">#    print(&#39;[df2] key=%r&#39; % key)</span>
<span class="c">#    # dicts modified from backend_qt4.py</span>
<span class="c">#    mpl2qtkey = {&#39;control&#39;: Qt.Key_Control, &#39;shift&#39;: Qt.Key_Shift,</span>
<span class="c">#                 &#39;alt&#39;: Qt.Key_Alt, &#39;super&#39;: Qt.Key_Meta,</span>
<span class="c">#                 &#39;enter&#39;: Qt.Key_Return, &#39;left&#39;: Qt.Key_Left, &#39;up&#39;: Qt.Key_Up,</span>
<span class="c">#                 &#39;right&#39;: Qt.Key_Right, &#39;down&#39;: Qt.Key_Down,</span>
<span class="c">#                 &#39;escape&#39;: Qt.Key_Escape, &#39;f1&#39;: Qt.Key_F1, &#39;f2&#39;: Qt.Key_F2,</span>
<span class="c">#                 &#39;f3&#39;: Qt.Key_F3, &#39;f4&#39;: Qt.Key_F4, &#39;f5&#39;: Qt.Key_F5,</span>
<span class="c">#                 &#39;f6&#39;: Qt.Key_F6, &#39;f7&#39;: Qt.Key_F7, &#39;f8&#39;: Qt.Key_F8,</span>
<span class="c">#                 &#39;f9&#39;: Qt.Key_F9, &#39;f10&#39;: Qt.Key_F10, &#39;f11&#39;: Qt.Key_F11,</span>
<span class="c">#                 &#39;f12&#39;: Qt.Key_F12, &#39;home&#39;: Qt.Key_Home, &#39;end&#39;: Qt.Key_End,</span>
<span class="c">#                 &#39;pageup&#39;: Qt.Key_PageUp, &#39;pagedown&#39;: Qt.Key_PageDown}</span>
<span class="c">#    # Reverse the control and super (aka cmd/apple) keys on OSX</span>
<span class="c">#    if sys.platform == &#39;darwin&#39;:</span>
<span class="c">#        mpl2qtkey.update({&#39;super&#39;: Qt.Key_Control, &#39;control&#39;: Qt.Key_Meta, })</span>

<span class="c">#    # Try to reconstruct QtGui.KeyEvent</span>
<span class="c">#    type_ = QtCore.QEvent.Type(QtCore.QEvent.KeyPress)  # The type should always be KeyPress</span>
<span class="c">#    text = &#39;&#39;</span>
<span class="c">#    # Try to extract the original modifiers</span>
<span class="c">#    modifiers = QtCore.Qt.NoModifier  # initialize to no modifiers</span>
<span class="c">#    if key.find(u&#39;ctrl+&#39;) &gt;= 0:</span>
<span class="c">#        modifiers = modifiers | QtCore.Qt.ControlModifier</span>
<span class="c">#        key = key.replace(u&#39;ctrl+&#39;, u&#39;&#39;)</span>
<span class="c">#        print(&#39;[df2] has ctrl modifier&#39;)</span>
<span class="c">#        text += &#39;Ctrl+&#39;</span>
<span class="c">#    if key.find(u&#39;alt+&#39;) &gt;= 0:</span>
<span class="c">#        modifiers = modifiers | QtCore.Qt.AltModifier</span>
<span class="c">#        key = key.replace(u&#39;alt+&#39;, u&#39;&#39;)</span>
<span class="c">#        print(&#39;[df2] has alt modifier&#39;)</span>
<span class="c">#        text += &#39;Alt+&#39;</span>
<span class="c">#    if key.find(u&#39;super+&#39;) &gt;= 0:</span>
<span class="c">#        modifiers = modifiers | QtCore.Qt.MetaModifier</span>
<span class="c">#        key = key.replace(u&#39;super+&#39;, u&#39;&#39;)</span>
<span class="c">#        print(&#39;[df2] has super modifier&#39;)</span>
<span class="c">#        text += &#39;Super+&#39;</span>
<span class="c">#    if key.isupper():</span>
<span class="c">#        modifiers = modifiers | QtCore.Qt.ShiftModifier</span>
<span class="c">#        print(&#39;[df2] has shift modifier&#39;)</span>
<span class="c">#        text += &#39;Shift+&#39;</span>
<span class="c">#    # Try to extract the original key</span>
<span class="c">#    try:</span>
<span class="c">#        if key in mpl2qtkey:</span>
<span class="c">#            key_ = mpl2qtkey[key]</span>
<span class="c">#        else:</span>
<span class="c">#            key_ = ord(key.upper())  # Qt works with uppercase keys</span>
<span class="c">#            text += key.upper()</span>
<span class="c">#    except Exception as ex:</span>
<span class="c">#        print(&#39;[df2] ERROR key=%r&#39; % key)</span>
<span class="c">#        print(&#39;[df2] ERROR %r&#39; % ex)</span>
<span class="c">#        raise</span>
<span class="c">#    autorep = False  # default false</span>
<span class="c">#    count   = 1  # default 1</span>
<span class="c">#    text = str(text)  # The text is somewhat arbitrary</span>
<span class="c">#    # Create the QEvent</span>
<span class="c">#    print(&#39;----------------&#39;)</span>
<span class="c">#    print(&#39;[df2] Create event&#39;)</span>
<span class="c">#    print(&#39;[df2] type_ = %r&#39; % type_)</span>
<span class="c">#    print(&#39;[df2] text = %r&#39; % text)</span>
<span class="c">#    print(&#39;[df2] modifiers = %r&#39; % modifiers)</span>
<span class="c">#    print(&#39;[df2] autorep = %r&#39; % autorep)</span>
<span class="c">#    print(&#39;[df2] count = %r &#39; % count)</span>
<span class="c">#    print(&#39;----------------&#39;)</span>
<span class="c">#    qevent = QtGui.QKeyEvent(type_, key_, modifiers, text, autorep, count)</span>
<span class="c">#    return qevent</span>


<span class="c">#def test_build_qkeyevent():</span>
<span class="c">#    import draw_func2 as df2</span>
<span class="c">#    qtwin = df2.QT4_WINS[0]</span>
<span class="c">#    # This reconstructs an test mplevent</span>
<span class="c">#    canvas = df2.figure(1).canvas</span>
<span class="c">#    mevent = mpl.backend_bases.KeyEvent(&#39;key_press_event&#39;, canvas, u&#39;ctrl+p&#39;, x=672, y=230.0)</span>
<span class="c">#    qevent = df2.convert_keypress_event_mpl_to_qt4(mevent)</span>
<span class="c">#    app = qtwin.backend.app</span>
<span class="c">#    app.sendEvent(qtwin.ui, mevent)</span>
<span class="c">#    #type_ = QtCore.QEvent.Type(QtCore.QEvent.KeyPress)  # The type should always be KeyPress</span>
<span class="c">#    #text = str(&#39;A&#39;)  # The text is somewhat arbitrary</span>
<span class="c">#    #modifiers = QtCore.Qt.NoModifier  # initialize to no modifiers</span>
<span class="c">#    #modifiers = modifiers | QtCore.Qt.ControlModifier</span>
<span class="c">#    #modifiers = modifiers | QtCore.Qt.AltModifier</span>
<span class="c">#    #key_ = ord(&#39;A&#39;)  # Qt works with uppercase keys</span>
<span class="c">#    #autorep = False  # default false</span>
<span class="c">#    #count   = 1  # default 1</span>
<span class="c">#    #qevent = QtGui.QKeyEvent(type_, key_, modifiers, text, autorep, count)</span>
<span class="c">#    return qevent</span>

</div>
<div class="viewcode-block" id="show_histogram"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.show_histogram">[docs]</a><span class="k">def</span> <span class="nf">show_histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;[df2] show_histogram()&#39;</span><span class="p">)</span>
    <span class="n">dmin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span>
    <span class="n">dmax</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
    <span class="k">if</span> <span class="n">bins</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="n">dmax</span> <span class="o">-</span> <span class="n">dmin</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">ax</span>  <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="n">dmin</span><span class="p">,</span> <span class="n">dmax</span><span class="p">))</span>
    <span class="c">#help(np.bincount)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="show_signature"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.show_signature">[docs]</a><span class="k">def</span> <span class="nf">show_signature</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="plot_stems"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.plot_stems">[docs]</a><span class="k">def</span> <span class="nf">plot_stems</span><span class="p">(</span><span class="n">x_data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">y_data</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">y_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">x_data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_data</span><span class="p">))</span>
        <span class="k">pass</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_data</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[df2] WARNING plot_stems(): len(x_data)!=len(y_data)&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[df2] WARNING plot_stems(): len(x_data)=len(y_data)=0&#39;</span><span class="p">)</span>
    <span class="n">x_data_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>
    <span class="n">y_data_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_data</span><span class="p">)</span>
    <span class="n">x_data_sort</span> <span class="o">=</span> <span class="n">x_data_</span><span class="p">[</span><span class="n">y_data_</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">y_data_sort</span> <span class="o">=</span> <span class="n">y_data_</span><span class="p">[</span><span class="n">y_data_</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

    <span class="n">markerline</span><span class="p">,</span> <span class="n">stemlines</span><span class="p">,</span> <span class="n">baseline</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">x_data_sort</span><span class="p">,</span> <span class="n">y_data_sort</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">markerline</span><span class="p">,</span> <span class="s">&#39;markerfacecolor&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">)</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="s">&#39;linewidth&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">y_data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">y_data</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_data</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="plot_sift_signature"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.plot_sift_signature">[docs]</a><span class="k">def</span> <span class="nf">plot_sift_signature</span><span class="p">(</span><span class="n">sift</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="n">plot_bars</span><span class="p">(</span><span class="n">sift</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
    <span class="n">space_xticks</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
    <span class="n">space_yticks</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
    <span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">dark_background</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>

</div>
<div class="viewcode-block" id="dark_background"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.dark_background">[docs]</a><span class="k">def</span> <span class="nf">dark_background</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">doubleit</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="n">bgcolor</span> <span class="o">=</span> <span class="n">BLACK</span> <span class="o">*</span> <span class="o">.</span><span class="mi">9</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">Axes3D</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_bgcolor</span><span class="p">(</span><span class="n">bgcolor</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">_axis_xy_width_height</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">doubleit</span><span class="p">:</span>
        <span class="n">halfw</span> <span class="o">=</span> <span class="p">(</span><span class="n">doubleit</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">halfh</span> <span class="o">=</span> <span class="p">(</span><span class="n">doubleit</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">xy</span> <span class="o">=</span> <span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">halfw</span><span class="p">,</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">halfh</span><span class="p">)</span>
        <span class="n">width</span> <span class="o">*=</span> <span class="p">(</span><span class="n">doubleit</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">height</span> <span class="o">*=</span> <span class="p">(</span><span class="n">doubleit</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">rect</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">rect</span><span class="o">.</span><span class="n">set_clip_on</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">rect</span><span class="o">.</span><span class="n">set_fill</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">rect</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">bgcolor</span><span class="p">)</span>
    <span class="n">rect</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="space_xticks"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.space_xticks">[docs]</a><span class="k">def</span> <span class="nf">space_xticks</span><span class="p">(</span><span class="n">nTicks</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nTicks</span><span class="p">)</span> <span class="o">*</span> <span class="n">spacing</span><span class="p">)</span>
    <span class="n">small_xticks</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="space_yticks"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.space_yticks">[docs]</a><span class="k">def</span> <span class="nf">space_yticks</span><span class="p">(</span><span class="n">nTicks</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nTicks</span><span class="p">)</span> <span class="o">*</span> <span class="n">spacing</span><span class="p">)</span>
    <span class="n">small_yticks</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="small_xticks"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.small_xticks">[docs]</a><span class="k">def</span> <span class="nf">small_xticks</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
        <span class="n">tick</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="small_yticks"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.small_yticks">[docs]</a><span class="k">def</span> <span class="nf">small_yticks</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
        <span class="n">tick</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="plot_bars"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.plot_bars">[docs]</a><span class="k">def</span> <span class="nf">plot_bars</span><span class="p">(</span><span class="n">y_data</span><span class="p">,</span> <span class="n">nColorSplits</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">nDims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_data</span><span class="p">)</span>
    <span class="n">nGroup</span> <span class="o">=</span> <span class="n">nDims</span> <span class="o">//</span> <span class="n">nColorSplits</span>
    <span class="n">ori_colors</span> <span class="o">=</span> <span class="n">distinct_colors</span><span class="p">(</span><span class="n">nColorSplits</span><span class="p">)</span>
    <span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nDims</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nColorSplits</span><span class="p">):</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nGroup</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">nGroup</span> <span class="o">*</span> <span class="n">ix</span><span class="p">)</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">ori_colors</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>
        <span class="n">x_dat</span> <span class="o">=</span> <span class="n">x_data</span><span class="p">[</span><span class="n">xs</span><span class="p">]</span>
        <span class="n">y_dat</span> <span class="o">=</span> <span class="n">y_data</span><span class="p">[</span><span class="n">xs</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x_dat</span><span class="p">,</span> <span class="n">y_dat</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">8</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="phantom_legend_label"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.phantom_legend_label">[docs]</a><span class="k">def</span> <span class="nf">phantom_legend_label</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s">&#39;upper right&#39;</span><span class="p">):</span>
    <span class="s">&#39;adds a legend label without displaying an actor&#39;</span>
    <span class="k">pass</span>
    <span class="c">#phantom_actor = plt.Circle((0, 0), 1, fc=color, prop=FONTS.legend, loc=loc)</span>
    <span class="c">#plt.legend(phant_actor, label, framealpha=.2)</span>
    <span class="c">#plt.legend(*zip(*legend_tups), framealpha=.2)</span>
    <span class="c">#legend_tups = []</span>
    <span class="c">#legend_tups.append((phantom_actor, label))</span>

</div>
<span class="n">LEGEND_LOCATION</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;upper right&#39;</span><span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>
    <span class="s">&#39;upper left&#39;</span><span class="p">:</span>   <span class="mi">2</span><span class="p">,</span>
    <span class="s">&#39;lower left&#39;</span><span class="p">:</span>   <span class="mi">3</span><span class="p">,</span>
    <span class="s">&#39;lower right&#39;</span><span class="p">:</span>  <span class="mi">4</span><span class="p">,</span>
    <span class="s">&#39;right&#39;</span><span class="p">:</span>        <span class="mi">5</span><span class="p">,</span>
    <span class="s">&#39;center left&#39;</span><span class="p">:</span>  <span class="mi">6</span><span class="p">,</span>
    <span class="s">&#39;center right&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
    <span class="s">&#39;lower center&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s">&#39;upper center&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
    <span class="s">&#39;center&#39;</span><span class="p">:</span>      <span class="mi">10</span><span class="p">,</span>
<span class="p">}</span>


<div class="viewcode-block" id="legend"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.legend">[docs]</a><span class="k">def</span> <span class="nf">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;upper right&#39;</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="n">FONTS</span><span class="o">.</span><span class="n">legend</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="plot_histpdf"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.plot_histpdf">[docs]</a><span class="k">def</span> <span class="nf">plot_histpdf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">draw_support</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">freq</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">plot_hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="n">nbins</span><span class="p">)</span>
    <span class="n">plot_pdf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">draw_support</span><span class="o">=</span><span class="n">draw_support</span><span class="p">,</span> <span class="n">scale_to</span><span class="o">=</span><span class="n">freq</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="plot_hist"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.plot_hist">[docs]</a><span class="k">def</span> <span class="nf">plot_hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">dmin</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">dmax</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">bins</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="n">dmax</span> <span class="o">-</span> <span class="n">dmin</span>
    <span class="n">ax</span>  <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="n">freq</span><span class="p">,</span> <span class="n">bins_</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">nbins</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="n">dmin</span><span class="p">,</span> <span class="n">dmax</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">freq</span><span class="p">,</span> <span class="n">bins_</span>

</div>
<div class="viewcode-block" id="variation_trunctate"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.variation_trunctate">[docs]</a><span class="k">def</span> <span class="nf">variation_trunctate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">warnstr</span> <span class="o">=</span> <span class="s">&#39;[df2] ! Warning: len(data) = 0. Cannot variation_truncate&#39;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">warnstr</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">trunc_max</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="n">trunc_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">trunc_min</span><span class="p">,</span> <span class="n">trunc_max</span><span class="p">)</span>
    <span class="c">#trunc_xticks = np.linspace(0, int(trunc_max),11)</span>
    <span class="c">#trunc_xticks = trunc_xticks[trunc_xticks &gt;= trunc_min]</span>
    <span class="c">#trunc_xticks = np.append([int(trunc_min)], trunc_xticks)</span>
    <span class="c">#no_zero_yticks = ax.get_yticks()[ax.get_yticks() &gt; 0]</span>
    <span class="c">#ax.set_xticks(trunc_xticks)</span>
    <span class="c">#ax.set_yticks(no_zero_yticks)</span>
<span class="c">#_----------------- HELPERS ^^^ ---------</span>

</div>
<div class="viewcode-block" id="scores_to_color"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.scores_to_color">[docs]</a><span class="k">def</span> <span class="nf">scores_to_color</span><span class="p">(</span><span class="n">score_list</span><span class="p">,</span> <span class="n">cmap_</span><span class="o">=</span><span class="s">&#39;hot&#39;</span><span class="p">,</span> <span class="n">logscale</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39;scores_to_color()&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">score_list</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;score must be 1d&#39;</span>
    <span class="k">if</span> <span class="n">logscale</span><span class="p">:</span>
        <span class="n">score_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">score_list</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap_</span><span class="p">)</span>
    <span class="n">mins</span> <span class="o">=</span> <span class="n">score_list</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">rnge</span> <span class="o">=</span> <span class="n">score_list</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">mins</span>
    <span class="k">if</span> <span class="n">rnge</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">cmap</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">fx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">score_list</span><span class="p">))]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">logscale</span><span class="p">:</span>
            <span class="n">score2_01</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">score</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="mf">1.1</span> <span class="o">+</span> <span class="o">.</span><span class="mi">9</span> <span class="o">*</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="o">-</span> <span class="n">mins</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">rnge</span><span class="p">))</span>
            <span class="n">score_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">score_list</span><span class="p">)</span>
            <span class="c">#rank_multiplier = score_list.argsort() / len(score_list)</span>
            <span class="c">#normscore = np.array(list(map(score2_01, score_list))) * rank_multiplier</span>
            <span class="n">normscore</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">score2_01</span><span class="p">,</span> <span class="n">score_list</span><span class="p">)))</span>
            <span class="n">colors</span> <span class="o">=</span>  <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">normscore</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">score2_01</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">score</span><span class="p">:</span> <span class="o">.</span><span class="mi">1</span> <span class="o">+</span> <span class="o">.</span><span class="mi">9</span> <span class="o">*</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="o">-</span> <span class="n">mins</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">rnge</span><span class="p">)</span>
        <span class="n">colors</span>    <span class="o">=</span> <span class="p">[</span><span class="n">cmap</span><span class="p">(</span><span class="n">score2_01</span><span class="p">(</span><span class="n">score</span><span class="p">))</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">score_list</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">colors</span>

</div>
<div class="viewcode-block" id="scores_to_cmap"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.scores_to_cmap">[docs]</a><span class="k">def</span> <span class="nf">scores_to_cmap</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cmap_</span><span class="o">=</span><span class="s">&#39;hot&#39;</span><span class="p">):</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39;scores_to_cmap()&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">scores_to_color</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">cmap_</span><span class="o">=</span><span class="n">cmap_</span><span class="p">)</span>
    <span class="n">sorted_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">colors</span><span class="p">))]</span>
    <span class="c"># Make a listed colormap and mappable object</span>
    <span class="n">listed_cmap</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span><span class="n">sorted_colors</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">listed_cmap</span>

</div>
<div class="viewcode-block" id="ensure_divider"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.ensure_divider">[docs]</a><span class="k">def</span> <span class="nf">ensure_divider</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Returns previously constructed divider or creates one &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s">&#39;_df2_divider&#39;</span><span class="p">):</span>
        <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">_df2_divider</span> <span class="o">=</span> <span class="n">divider</span>
    <span class="k">return</span> <span class="n">ax</span><span class="o">.</span><span class="n">_df2_divider</span>

</div>
<div class="viewcode-block" id="colorbar"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.colorbar">[docs]</a><span class="k">def</span> <span class="nf">colorbar</span><span class="p">(</span><span class="n">scalars</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; adds a color bar next to the axes &quot;&quot;&quot;</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39;colorbar()&#39;</span><span class="p">)</span>
    <span class="c"># Parameters</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="n">divider</span> <span class="o">=</span> <span class="n">ensure_divider</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

    <span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">_axis_xy_width_height</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="c">#orientation = [&#39;vertical&#39;, &#39;horizontal&#39;][0]</span>
    <span class="n">TICK_FONTSIZE</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="c">#</span>
    <span class="n">listed_cmap</span> <span class="o">=</span> <span class="n">scores_to_cmap</span><span class="p">(</span><span class="n">scalars</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>
    <span class="c"># Create scalar mappable with cmap</span>
    <span class="n">sorted_scalars</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">listed_cmap</span><span class="p">)</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">sorted_scalars</span><span class="p">)</span>
    <span class="c"># Use mapable object to create the colorbar</span>
    <span class="c">#COLORBAR_SHRINK = .42  # 1</span>
    <span class="c">#COLORBAR_PAD = .01  # 1</span>
    <span class="c">#COLORBAR_ASPECT = np.abs(20 * height / (width))  # 1</span>
    <span class="c">#printDBG(&#39;[df] COLORBAR_ASPECT = %r&#39; % COLORBAR_ASPECT)</span>

    <span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span>

    <span class="c">## Add the colorbar to the correct label</span>
    <span class="n">axis</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span>  <span class="c"># if orientation == &#39;horizontal&#39; else cb.ax.yaxis</span>
    <span class="c">#position = &#39;bottom&#39; if orientation == &#39;horizontal&#39; else &#39;right&#39;</span>
    <span class="c">#axis.set_ticks_position(position)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">TICK_FONTSIZE</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="draw_lines2"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.draw_lines2">[docs]</a><span class="k">def</span> <span class="nf">draw_lines2</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">kpts2_offset</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">color_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.4</span><span class="p">,</span> <span class="n">line_alpha</span><span class="o">=.</span><span class="mi">35</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39;-------------&#39;</span><span class="p">)</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39;draw_lines2()&#39;</span><span class="p">)</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39; * len(fm) = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">))</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39; * scale_factor = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">scale_factor</span><span class="p">)</span>
    <span class="c"># input data</span>
    <span class="k">if</span> <span class="n">fm</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>  <span class="c"># assume kpts are in director correspondence</span>
        <span class="k">assert</span> <span class="n">kpts1</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">kpts2</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="n">woff</span><span class="p">,</span> <span class="n">hoff</span> <span class="o">=</span> <span class="n">kpts2_offset</span>
    <span class="c"># Draw line collection</span>
    <span class="n">kpts1_m</span> <span class="o">=</span> <span class="n">kpts1</span><span class="p">[</span><span class="n">fm</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span>
    <span class="n">kpts2_m</span> <span class="o">=</span> <span class="n">kpts2</span><span class="p">[</span><span class="n">fm</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span>
    <span class="n">xxyy_iter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">kpts1_m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">scale_factor</span><span class="p">,</span>
                         <span class="n">kpts2_m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">scale_factor</span> <span class="o">+</span> <span class="n">woff</span><span class="p">,</span>
                         <span class="n">kpts1_m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">scale_factor</span><span class="p">,</span>
                         <span class="n">kpts2_m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">scale_factor</span> <span class="o">+</span> <span class="n">hoff</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">color_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">fs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>  <span class="c"># Draw with solid color</span>
            <span class="n">color_list</span>    <span class="o">=</span> <span class="p">[</span><span class="n">RED</span> <span class="k">for</span> <span class="n">fx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">))]</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># Draw with colors proportional to score difference</span>
            <span class="n">color_list</span> <span class="o">=</span> <span class="n">scores_to_color</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">segments</span>  <span class="o">=</span> <span class="p">[((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">xxyy_iter</span><span class="p">]</span>
    <span class="n">linewidth</span> <span class="o">=</span> <span class="p">[</span><span class="n">lw</span> <span class="k">for</span> <span class="n">fx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">))]</span>
    <span class="n">line_alpha</span> <span class="o">=</span> <span class="n">line_alpha</span>
    <span class="n">line_group</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">(</span><span class="n">segments</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">,</span> <span class="n">color_list</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">line_alpha</span><span class="p">)</span>
    <span class="c">#plt.colorbar(line_group, ax=ax)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_group</span><span class="p">)</span>
    <span class="c">#figure(100)</span>
    <span class="c">#plt.hexbin(x,y, cmap=plt.cm.YlOrRd_r)</span>

</div>
<div class="viewcode-block" id="draw_kpts2"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.draw_kpts2">[docs]</a><span class="k">def</span> <span class="nf">draw_kpts2</span><span class="p">(</span><span class="n">kpts</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">scale_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">ell</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">pts</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">eig</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
               <span class="n">pts_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ell_alpha</span><span class="o">=.</span><span class="mi">6</span><span class="p">,</span> <span class="n">ell_linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
               <span class="n">ell_color</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">pts_color</span><span class="o">=</span><span class="n">ORANGE</span><span class="p">,</span> <span class="n">color_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">ell_color</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ell_color</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;color&#39;</span><span class="p">,</span> <span class="n">BLUE</span><span class="p">)</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39;-------------&#39;</span><span class="p">)</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39;draw_kpts2():&#39;</span><span class="p">)</span>
    <span class="c">#printDBG(&#39; * kwargs.keys()=%r&#39; % (kwargs.keys(),))</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39; * kpts.shape=</span><span class="si">%r</span><span class="s">:&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">kpts</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39; * ell=</span><span class="si">%r</span><span class="s"> pts=</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ell</span><span class="p">,</span> <span class="n">pts</span><span class="p">))</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39; * rect=</span><span class="si">%r</span><span class="s"> eig=</span><span class="si">%r</span><span class="s">, ori=</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rect</span><span class="p">,</span> <span class="n">eig</span><span class="p">,</span> <span class="n">ori</span><span class="p">))</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39; * scale_factor=</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">scale_factor</span><span class="p">,))</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39; * offset=</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">offset</span><span class="p">,))</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39; * drawing kpts.shape=</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">kpts</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;len(kpts) &lt; 0&#39;</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="n">ell_alpha</span> <span class="o">=</span> <span class="n">ell_alpha</span>
    <span class="k">if</span> <span class="n">color_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ell_color</span> <span class="o">=</span> <span class="n">color_list</span>
        <span class="n">pts_color</span> <span class="o">=</span> <span class="n">color_list</span>
    <span class="c">#else:</span>
        <span class="c">#pts_color = [pts_color for _ in range(len(kpts))]</span>
    <span class="k">if</span> <span class="n">ell_color</span> <span class="o">==</span> <span class="s">&#39;distinct&#39;</span><span class="p">:</span>
        <span class="n">ell_color</span> <span class="o">=</span> <span class="n">distinct_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kpts</span><span class="p">))</span>

    <span class="n">_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
        <span class="c"># offsets</span>
        <span class="s">&#39;offset&#39;</span><span class="p">:</span> <span class="n">offset</span><span class="p">,</span>
        <span class="s">&#39;scale_factor&#39;</span><span class="p">:</span> <span class="n">scale_factor</span><span class="p">,</span>
        <span class="c"># flags</span>
        <span class="s">&#39;pts&#39;</span><span class="p">:</span> <span class="n">pts</span><span class="p">,</span>
        <span class="s">&#39;ell&#39;</span><span class="p">:</span> <span class="n">ell</span><span class="p">,</span>
        <span class="s">&#39;ori&#39;</span><span class="p">:</span> <span class="n">ori</span><span class="p">,</span>
        <span class="s">&#39;rect&#39;</span><span class="p">:</span> <span class="n">rect</span><span class="p">,</span>
        <span class="s">&#39;eig&#39;</span><span class="p">:</span> <span class="n">eig</span><span class="p">,</span>
        <span class="c"># properties</span>
        <span class="s">&#39;ell_color&#39;</span><span class="p">:</span> <span class="n">ell_color</span><span class="p">,</span>
        <span class="s">&#39;ell_alpha&#39;</span><span class="p">:</span> <span class="n">ell_alpha</span><span class="p">,</span>
        <span class="s">&#39;pts_color&#39;</span><span class="p">:</span> <span class="n">pts_color</span><span class="p">,</span>
        <span class="s">&#39;ell_linewidth&#39;</span><span class="p">:</span> <span class="n">ell_linewidth</span><span class="p">,</span>
    <span class="p">})</span>

    <span class="n">mpl_kp</span><span class="o">.</span><span class="n">draw_keypoints</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">kpts</span><span class="p">,</span> <span class="o">**</span><span class="n">_kwargs</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="draw_keypoint_gradient_orientations"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.draw_keypoint_gradient_orientations">[docs]</a><span class="k">def</span> <span class="nf">draw_keypoint_gradient_orientations</span><span class="p">(</span><span class="n">rchip</span><span class="p">,</span> <span class="n">kp</span><span class="p">,</span> <span class="n">sift</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;vec&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">wpatch</span><span class="p">,</span> <span class="n">wkp</span>  <span class="o">=</span> <span class="n">ptool</span><span class="o">.</span><span class="n">get_warped_patch</span><span class="p">(</span><span class="n">rchip</span><span class="p">,</span> <span class="n">kp</span><span class="p">,</span> <span class="n">gray</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">gradx</span><span class="p">,</span> <span class="n">grady</span> <span class="o">=</span> <span class="n">ptool</span><span class="o">.</span><span class="n">patch_gradient</span><span class="p">(</span><span class="n">wpatch</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;!!!!!!!!!!!!&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[df2!] Exception = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ex</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;---------&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;type(wpatch) = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">wpatch</span><span class="p">)))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;repr(wpatch) = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">wpatch</span><span class="p">)))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;wpatch = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">wpatch</span><span class="p">))</span>
        <span class="k">raise</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s">&#39;vec&#39;</span><span class="p">:</span>
        <span class="n">draw_vector_field</span><span class="p">(</span><span class="n">gradx</span><span class="p">,</span> <span class="n">grady</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s">&#39;col&#39;</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">plottool</span> <span class="kn">as</span> <span class="nn">dtool</span>
        <span class="n">gmag</span> <span class="o">=</span> <span class="n">ptool</span><span class="o">.</span><span class="n">patch_mag</span><span class="p">(</span><span class="n">gradx</span><span class="p">,</span> <span class="n">grady</span><span class="p">)</span>
        <span class="n">gori</span> <span class="o">=</span> <span class="n">ptool</span><span class="o">.</span><span class="n">patch_ori</span><span class="p">(</span><span class="n">gradx</span><span class="p">,</span> <span class="n">grady</span><span class="p">)</span>
        <span class="n">gorimag</span> <span class="o">=</span> <span class="n">dtool</span><span class="o">.</span><span class="n">color_orimag</span><span class="p">(</span><span class="n">gori</span><span class="p">,</span> <span class="n">gmag</span><span class="p">)</span>
        <span class="n">imshow</span><span class="p">(</span><span class="n">gorimag</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">wkpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">wkp</span><span class="p">])</span>
    <span class="n">sifts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sift</span><span class="p">])</span>
    <span class="n">draw_kpts2</span><span class="p">(</span><span class="n">wkpts</span><span class="p">,</span> <span class="n">sifts</span><span class="o">=</span><span class="n">sifts</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

</div>
<span class="nd">@utool.indent_func</span><span class="p">(</span><span class="s">&#39;[df2.dkp]&#39;</span><span class="p">)</span>
<div class="viewcode-block" id="draw_keypoint_patch"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.draw_keypoint_patch">[docs]</a><span class="k">def</span> <span class="nf">draw_keypoint_patch</span><span class="p">(</span><span class="n">rchip</span><span class="p">,</span> <span class="n">kp</span><span class="p">,</span> <span class="n">sift</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">warped</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">patch_dict</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c">#print(&#39;--------------------&#39;)</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39;[df2] draw_keypoint_patch()&#39;</span><span class="p">)</span>
    <span class="n">kpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">kp</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">warped</span><span class="p">:</span>
        <span class="n">patches</span><span class="p">,</span> <span class="n">subkpts</span> <span class="o">=</span> <span class="n">ptool</span><span class="o">.</span><span class="n">get_warped_patches</span><span class="p">(</span><span class="n">rchip</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">patches</span><span class="p">,</span> <span class="n">subkpts</span> <span class="o">=</span> <span class="n">ptool</span><span class="o">.</span><span class="n">get_unwarped_patches</span><span class="p">(</span><span class="n">rchip</span><span class="p">,</span> <span class="n">kpts</span><span class="p">)</span>
    <span class="c">#print(&#39;[df2] kpts[0]    = %r&#39; % (kpts[0]))</span>
    <span class="c">#print(&#39;[df2] subkpts[0] = %r&#39; % (subkpts[0]))</span>
    <span class="c">#print(&#39;[df2] patches[0].shape = %r&#39; % (patches[0].shape,))</span>
    <span class="n">patch</span> <span class="o">=</span> <span class="n">patches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">subkpts_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">subkpts</span><span class="p">)</span>
    <span class="n">patch_dict_</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;sifts&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sift</span><span class="p">]),</span>
        <span class="s">&#39;ell_color&#39;</span><span class="p">:</span>  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s">&#39;pts&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
        <span class="s">&#39;ori&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
        <span class="s">&#39;ell&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
        <span class="s">&#39;eig&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
        <span class="s">&#39;rect&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">patch_dict_</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">patch_dict</span><span class="p">)</span>
    <span class="c"># Draw patch with keypoint overlay</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">imshow</span><span class="p">(</span><span class="n">patch</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">draw_kpts2</span><span class="p">(</span><span class="n">subkpts_</span><span class="p">,</span> <span class="o">**</span><span class="n">patch_dict_</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>


<span class="c"># ---- CHIP DISPLAY COMMANDS ----</span></div>
<div class="viewcode-block" id="imshow"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.imshow">[docs]</a><span class="k">def</span> <span class="nf">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
           <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">heatmap</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
           <span class="n">data_colorbar</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">darken</span><span class="o">=</span><span class="n">DARKEN</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="s">&#39;other interpolations = nearest, bicubic, bilinear&#39;</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39;imshow()&#39;</span><span class="p">)</span>
    <span class="c">#printDBG(&#39;[df2] ----- IMSHOW ------ &#39;)</span>
    <span class="c">#printDBG(&#39;[***df2.imshow] fnum=%r pnum=%r title=%r *** &#39; % (fnum, pnum, title))</span>
    <span class="c">#printDBG(&#39;[***df2.imshow] img.shape = %r &#39; % (img.shape,))</span>
    <span class="c">#printDBG(&#39;[***df2.imshow] img.stats = %r &#39; % (utool.get_stats_str(img),))</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">figtitle</span><span class="o">=</span><span class="n">figtitle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">darken</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c"># Darken the shown picture</span>
        <span class="n">imgdtype</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">dtype</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> <span class="o">*</span> <span class="n">darken</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">imgdtype</span><span class="p">)</span>

    <span class="n">plt_imshow_kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;interpolation&#39;</span><span class="p">:</span> <span class="n">interpolation</span><span class="p">,</span>
        <span class="c">#&#39;cmap&#39;: plt.get_cmap(&#39;gray&#39;),</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">heatmap</span><span class="p">:</span>
        <span class="n">plt_imshow_kwargs</span><span class="p">[</span><span class="s">&#39;vmin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">plt_imshow_kwargs</span><span class="p">[</span><span class="s">&#39;vmax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
    <span class="k">if</span> <span class="n">heatmap</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="s">&#39;hot&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">or</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">):</span>
            <span class="c"># img is in a color format</span>
            <span class="n">imgBGR</span> <span class="o">=</span> <span class="n">img</span>
            <span class="k">if</span> <span class="n">imgBGR</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">imgBGR</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39;Drawing Float Color Image &lt; 1&#39;</span><span class="p">)</span>
                    <span class="n">imgBGR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39;Drawing Float Color Image &gt; 1&#39;</span><span class="p">)</span>
                    <span class="n">imgBGR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
            <span class="n">imgRGB</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">imgBGR</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgRGB</span><span class="p">,</span> <span class="o">**</span><span class="n">plt_imshow_kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c"># img is in grayscale</span>
            <span class="n">imgGRAY</span> <span class="o">=</span> <span class="n">img</span>
            <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s">&#39;gray&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgGRAY</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="o">**</span><span class="n">plt_imshow_kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;unknown image format&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">te</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[df2] imshow ERROR </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">te</span><span class="p">,))</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;!!!!!!!!!!!!!!WARNING!!!!!!!!!!!&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[df2] type(img) = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">img</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;!!!!!!!!!!!!!!ERRROR!!!!!!!!!!!&#39;</span><span class="p">)</span>
            <span class="k">pass</span>
            <span class="c">#print(&#39;img = %r&#39; % (img,))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[df2] img.dtype = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">dtype</span><span class="p">,))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[df2] type(img) = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">img</span><span class="p">),))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[df2] img.shape = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">,))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[df2] imshow ERROR </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">ex</span><span class="p">)</span>
        <span class="k">raise</span>
    <span class="c">#plt.set_cmap(&#39;gray&#39;)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

    <span class="k">if</span> <span class="n">data_colorbar</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">scores_to_color</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">cmap</span><span class="p">)</span>
        <span class="n">colorbar</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

</div>
<div class="viewcode-block" id="draw_vector_field"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.draw_vector_field">[docs]</a><span class="k">def</span> <span class="nf">draw_vector_field</span><span class="p">(</span><span class="n">gx</span><span class="p">,</span> <span class="n">gy</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c"># https://stackoverflow.com/questions/1843194/plotting-vector-fields-in-python-matplotlib</span>
    <span class="c"># http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.quiver</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39;[df2] draw_vector_vield()&#39;</span><span class="p">)</span>
    <span class="n">quiv_kw</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;units&#39;</span><span class="p">:</span> <span class="s">&#39;xy&#39;</span><span class="p">,</span>
        <span class="s">&#39;scale_units&#39;</span><span class="p">:</span> <span class="s">&#39;xy&#39;</span><span class="p">,</span>
        <span class="c">#&#39;angles&#39;: &#39;uv&#39;,</span>
        <span class="c">#&#39;scale&#39;: 80,</span>
        <span class="c">#&#39;width&#39;:</span>
        <span class="s">&#39;headaxislength&#39;</span><span class="p">:</span> <span class="mf">4.5</span><span class="p">,</span>
        <span class="s">&#39;headlength&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
        <span class="s">&#39;headwidth&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s">&#39;minshaft&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">&#39;minlength&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="c">#&#39;color&#39;: &#39;r&#39;,</span>
        <span class="c">#&#39;edgecolor&#39;: &#39;k&#39;,</span>
        <span class="s">&#39;linewidths&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">,),</span>
        <span class="s">&#39;pivot&#39;</span><span class="p">:</span> <span class="s">&#39;tail&#39;</span><span class="p">,</span>  <span class="c"># &#39;middle&#39;,</span>
    <span class="p">}</span>
    <span class="n">stride</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">np</span><span class="o">.</span><span class="n">tau</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">x_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">gx</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">gy</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c"># Vector locations and directions</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span> <span class="n">y_grid</span><span class="p">)</span>
    <span class="n">U</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">gx</span><span class="p">,</span> <span class="o">-</span><span class="n">gy</span>
    <span class="c"># Apply stride</span>
    <span class="n">X_</span> <span class="o">=</span> <span class="n">X</span><span class="p">[::</span><span class="n">stride</span><span class="p">,</span> <span class="p">::</span><span class="n">stride</span><span class="p">]</span>
    <span class="n">Y_</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[::</span><span class="n">stride</span><span class="p">,</span> <span class="p">::</span><span class="n">stride</span><span class="p">]</span>
    <span class="n">U_</span> <span class="o">=</span> <span class="n">U</span><span class="p">[::</span><span class="n">stride</span><span class="p">,</span> <span class="p">::</span><span class="n">stride</span><span class="p">]</span>
    <span class="n">V_</span> <span class="o">=</span> <span class="n">V</span><span class="p">[::</span><span class="n">stride</span><span class="p">,</span> <span class="p">::</span><span class="n">stride</span><span class="p">]</span>
    <span class="c"># Draw arrows</span>
    <span class="n">figure</span><span class="p">(</span><span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X_</span><span class="p">,</span> <span class="n">Y_</span><span class="p">,</span> <span class="n">U_</span><span class="p">,</span> <span class="n">V_</span><span class="p">,</span> <span class="o">**</span><span class="n">quiv_kw</span><span class="p">)</span>
    <span class="c"># Plot properties</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s">&#39;equal&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="show_chipmatch2"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.show_chipmatch2">[docs]</a><span class="k">def</span> <span class="nf">show_chipmatch2</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                    <span class="n">vert</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">heatmap</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                    <span class="n">draw_fmatch</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Draws two chips and the feature matches between them. feature matches</span>
<span class="sd">    kpts1 and kpts2 use the (x,y,a,c,d)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39;[df2] draw_matches2() fnum=</span><span class="si">%r</span><span class="s">, pnum=</span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="p">))</span>
    <span class="c"># get matching keypoints + offset</span>
    <span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">w1</span><span class="p">)</span> <span class="o">=</span> <span class="n">rchip1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>  <span class="c"># get chip (h, w) dimensions</span>
    <span class="p">(</span><span class="n">h2</span><span class="p">,</span> <span class="n">w2</span><span class="p">)</span> <span class="o">=</span> <span class="n">rchip2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
    <span class="c"># Stack the compared chips</span>
    <span class="n">match_img</span><span class="p">,</span> <span class="n">woff</span><span class="p">,</span> <span class="n">hoff</span> <span class="o">=</span> <span class="n">stack_images</span><span class="p">(</span><span class="n">rchip1</span><span class="p">,</span> <span class="n">rchip2</span><span class="p">,</span> <span class="n">vert</span><span class="p">)</span>
    <span class="n">xywh1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">h1</span><span class="p">)</span>
    <span class="n">xywh2</span> <span class="o">=</span> <span class="p">(</span><span class="n">woff</span><span class="p">,</span> <span class="n">hoff</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
    <span class="c"># Show the stacked chips</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">imshow</span><span class="p">(</span><span class="n">match_img</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">fnum</span><span class="o">=</span><span class="n">fnum</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="n">pnum</span><span class="p">,</span> <span class="n">heatmap</span><span class="o">=</span><span class="n">heatmap</span><span class="p">)</span>
    <span class="c"># Overlay feature match nnotations</span>
    <span class="k">if</span> <span class="n">draw_fmatch</span> <span class="ow">and</span> <span class="n">kpts1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">kpts2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">plot_fmatch</span><span class="p">(</span><span class="n">xywh1</span><span class="p">,</span> <span class="n">xywh2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span><span class="p">,</span> <span class="n">xywh1</span><span class="p">,</span> <span class="n">xywh2</span>


<span class="c"># plot feature match</span></div>
<div class="viewcode-block" id="plot_fmatch"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.plot_fmatch">[docs]</a><span class="k">def</span> <span class="nf">plot_fmatch</span><span class="p">(</span><span class="n">xywh1</span><span class="p">,</span> <span class="n">xywh2</span><span class="p">,</span> <span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">lbl1</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">lbl2</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">fnum</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">pnum</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">colorbar_</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                <span class="n">draw_border</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Draws the matching features. This is draw because it is an overlay</span>
<span class="sd">    xywh1 - location of rchip1 in the axes</span>
<span class="sd">    xywh2 - location or rchip2 in the axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">printDBG</span><span class="p">(</span><span class="s">&#39;[df2] plot_fmatch&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fm</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">kpts1</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">kpts2</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s">&#39;shapes different or fm not none&#39;</span>
        <span class="n">fm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">kpts1</span><span class="p">)),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
    <span class="n">pts</span>       <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;draw_pts&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
    <span class="n">ell</span>       <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;draw_ell&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
    <span class="n">lines</span>     <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;draw_lines&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
    <span class="n">ell_alpha</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;ell_alpha&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">nMatch</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">)</span>
    <span class="c">#printDBG(&#39;[df2.draw_fnmatch] nMatch=%r&#39; % nMatch)</span>
    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">h1</span> <span class="o">=</span> <span class="n">xywh1</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">h2</span> <span class="o">=</span> <span class="n">xywh2</span>
    <span class="n">offset2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
    <span class="c"># THIS IS NOT WHERE THIS CODE BELONGS</span>
    <span class="k">if</span> <span class="bp">False</span><span class="p">:</span>
        <span class="c"># Custom user label for chips 1 and 2</span>
        <span class="k">if</span> <span class="n">lbl1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">absolute_lbl</span><span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">w1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">lbl1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lbl2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">absolute_lbl</span><span class="p">(</span><span class="n">x2</span> <span class="o">+</span> <span class="n">w2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">lbl2</span><span class="p">)</span>
    <span class="c"># Plot the number of matches</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;show_nMatches&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
        <span class="n">upperleft_text</span><span class="p">(</span><span class="s">&#39;#match=</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">nMatch</span><span class="p">)</span>
    <span class="c"># Draw all keypoints in both chips as points</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;all_kpts&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
        <span class="n">all_args</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ell</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">pts</span><span class="o">=</span><span class="n">pts</span><span class="p">,</span> <span class="n">pts_color</span><span class="o">=</span><span class="n">GREEN</span><span class="p">,</span> <span class="n">pts_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">ell_alpha</span><span class="o">=</span><span class="n">ell_alpha</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="n">rect</span><span class="p">)</span>
        <span class="n">all_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="o">**</span><span class="n">all_args</span><span class="p">)</span>
        <span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts2</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset2</span><span class="p">,</span> <span class="o">**</span><span class="n">all_args</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">draw_border</span><span class="p">:</span>
        <span class="n">draw_bbox</span><span class="p">(</span><span class="n">xywh1</span><span class="p">,</span> <span class="n">bbox_color</span><span class="o">=</span><span class="n">BLACK</span><span class="p">,</span> <span class="n">draw_arrow</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">draw_bbox</span><span class="p">(</span><span class="n">xywh2</span><span class="p">,</span> <span class="n">bbox_color</span><span class="o">=</span><span class="n">BLACK</span><span class="p">,</span> <span class="n">draw_arrow</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="c"># Draw Lines and Ellipses and Points oh my</span>
    <span class="k">if</span> <span class="n">nMatch</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;colors&#39;</span><span class="p">]]</span> <span class="o">*</span> <span class="n">nMatch</span> <span class="k">if</span> <span class="s">&#39;colors&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="n">distinct_colors</span><span class="p">(</span><span class="n">nMatch</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">scores_to_color</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="s">&#39;hot&#39;</span><span class="p">)</span>

        <span class="n">acols</span> <span class="o">=</span> <span class="n">add_alpha</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>

        <span class="c"># Helper functions</span>
        <span class="k">def</span> <span class="nf">_drawkpts</span><span class="p">(</span><span class="o">**</span><span class="n">_kwargs</span><span class="p">):</span>
            <span class="n">_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">fxs1</span> <span class="o">=</span> <span class="n">fm</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">fxs2</span> <span class="o">=</span> <span class="n">fm</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts1</span><span class="p">[</span><span class="n">fxs1</span><span class="p">],</span> <span class="n">rect</span><span class="o">=</span><span class="n">rect</span><span class="p">,</span> <span class="o">**</span><span class="n">_kwargs</span><span class="p">)</span>
            <span class="n">draw_kpts2</span><span class="p">(</span><span class="n">kpts2</span><span class="p">[</span><span class="n">fxs2</span><span class="p">],</span> <span class="n">offset</span><span class="o">=</span><span class="n">offset2</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="n">rect</span><span class="p">,</span> <span class="o">**</span><span class="n">_kwargs</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">_drawlines</span><span class="p">(</span><span class="o">**</span><span class="n">_kwargs</span><span class="p">):</span>
            <span class="n">_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">draw_lines2</span><span class="p">(</span><span class="n">kpts1</span><span class="p">,</span> <span class="n">kpts2</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">kpts2_offset</span><span class="o">=</span><span class="n">offset2</span><span class="p">,</span> <span class="o">**</span><span class="n">_kwargs</span><span class="p">)</span>

        <span class="c"># User utool</span>
        <span class="k">if</span> <span class="n">ell</span><span class="p">:</span>
            <span class="n">_drawkpts</span><span class="p">(</span><span class="n">pts</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">ell</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">color_list</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pts</span><span class="p">:</span>
            <span class="n">_drawkpts</span><span class="p">(</span><span class="n">pts_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">pts</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">ell</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">pts_color</span><span class="o">=</span><span class="n">BLACK</span><span class="p">)</span>
            <span class="n">_drawkpts</span><span class="p">(</span><span class="n">pts_size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">pts</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">ell</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">color_list</span><span class="o">=</span><span class="n">acols</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">_drawlines</span><span class="p">(</span><span class="n">color_list</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">draw_boxedX</span><span class="p">(</span><span class="n">xywh2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">colorbar_</span> <span class="ow">and</span> <span class="s">&#39;colors&#39;</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">()</span> <span class="ow">and</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">colorbar</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>
    <span class="c">#legend()</span>
    <span class="k">return</span> <span class="bp">None</span>

</div>
<div class="viewcode-block" id="draw_boxedX"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.draw_boxedX">[docs]</a><span class="k">def</span> <span class="nf">draw_boxedX</span><span class="p">(</span><span class="n">xywh</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">RED</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="s">&#39;draws a big red x. redx&#39;</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">xywh</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">xy</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">_axis_xy_width_height</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">xywh</span> <span class="o">=</span> <span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">xywh</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">w</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">h</span>
    <span class="n">segments</span> <span class="o">=</span> <span class="p">[((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)),</span>
                <span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">))]</span>
    <span class="n">trans</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">Affine2D</span><span class="p">()</span>
    <span class="n">trans</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">trans</span> <span class="o">=</span> <span class="n">trans</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span>
    <span class="n">width_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">lw</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span>
    <span class="n">color_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">color</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span>
    <span class="n">line_group</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">(</span><span class="n">segments</span><span class="p">,</span> <span class="n">width_list</span><span class="p">,</span> <span class="n">color_list</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                                <span class="n">transOffset</span><span class="o">=</span><span class="n">trans</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_group</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="color_orimag"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.color_orimag">[docs]</a><span class="k">def</span> <span class="nf">color_orimag</span><span class="p">(</span><span class="n">gori</span><span class="p">,</span> <span class="n">gmag</span><span class="p">):</span>
    <span class="c"># Turn a 0 to 1 orienation map into hsv colors</span>
    <span class="n">gori_01</span> <span class="o">=</span> <span class="p">(</span><span class="n">gori</span> <span class="o">-</span> <span class="n">gori</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span><span class="n">gori</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">gori</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
    <span class="n">cmap_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s">&#39;hsv&#39;</span><span class="p">)</span>
    <span class="n">flat_rgb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cmap_</span><span class="p">(</span><span class="n">gori_01</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">rgb_ori_alpha</span> <span class="o">=</span> <span class="n">flat_rgb</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">gori</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">])))</span>
    <span class="n">rgb_ori</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">rgb_ori_alpha</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_RGBA2RGB</span><span class="p">)</span>
    <span class="n">hsv_ori</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">rgb_ori</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_RGB2HSV</span><span class="p">)</span>
    <span class="c"># Desaturate colors based on magnitude</span>
    <span class="n">hsv_ori</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">gmag</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">)</span>
    <span class="n">hsv_ori</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">gmag</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">)</span>
    <span class="c"># Convert back to bgr</span>
    <span class="n">bgr_ori</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">hsv_ori</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_HSV2RGB</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bgr_ori</span>

</div>
<div class="viewcode-block" id="stack_image_list"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.stack_image_list">[docs]</a><span class="k">def</span> <span class="nf">stack_image_list</span><span class="p">(</span><span class="n">img_list</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">img_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="n">imgB</span> <span class="o">=</span> <span class="n">img_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">offset_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">img2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">img_list</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">imgB</span><span class="p">,</span> <span class="n">woff</span><span class="p">,</span> <span class="n">hoff</span> <span class="o">=</span> <span class="n">stack_images</span><span class="p">(</span><span class="n">imgB</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">offset_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">woff</span><span class="p">,</span> <span class="n">hoff</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">imgB</span>

</div>
<div class="viewcode-block" id="stack_image_recurse"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.stack_image_recurse">[docs]</a><span class="k">def</span> <span class="nf">stack_image_recurse</span><span class="p">(</span><span class="n">img_list1</span><span class="p">,</span> <span class="n">img_list2</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">img_list2</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c"># Initialization and error checking</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">img_list1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">img_list1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">img_list1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">stack_image_recurse</span><span class="p">(</span><span class="n">img_list1</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">img_list1</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">vert</span><span class="o">=</span><span class="n">vert</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">img_list1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c"># Left base case</span>
        <span class="n">img1</span> <span class="o">=</span> <span class="n">img_list1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c"># Left recurse</span>
        <span class="n">img1</span> <span class="o">=</span> <span class="n">stack_image_recurse</span><span class="p">(</span><span class="n">img_list1</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">img_list1</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">vert</span><span class="o">=</span><span class="ow">not</span> <span class="n">vert</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">img_list2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c"># Right base case</span>
        <span class="n">img2</span> <span class="o">=</span> <span class="n">img_list2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c"># Right Recurse</span>
        <span class="n">img2</span> <span class="o">=</span> <span class="n">stack_image_recurse</span><span class="p">(</span><span class="n">img_list2</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">img_list2</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">vert</span><span class="o">=</span><span class="ow">not</span> <span class="n">vert</span><span class="p">)</span>
    <span class="n">imgB</span><span class="p">,</span> <span class="n">woff</span><span class="p">,</span> <span class="n">hoff</span> <span class="o">=</span> <span class="n">stack_images</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="n">vert</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">imgB</span>

</div>
<div class="viewcode-block" id="stack_images"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.stack_images">[docs]</a><span class="k">def</span> <span class="nf">stack_images</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">img2</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c"># TODO: move this to the same place I&#39;m doing the color gradient</span>
    <span class="n">nChannels</span> <span class="o">=</span> <span class="n">gtool</span><span class="o">.</span><span class="n">get_num_channels</span><span class="p">(</span><span class="n">img1</span><span class="p">)</span>
    <span class="n">nChannels2</span> <span class="o">=</span> <span class="n">gtool</span><span class="o">.</span><span class="n">get_num_channels</span><span class="p">(</span><span class="n">img2</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">nChannels</span> <span class="o">==</span> <span class="n">nChannels2</span>
    <span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">w1</span><span class="p">)</span> <span class="o">=</span> <span class="n">img1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">]</span>  <span class="c"># get chip dimensions</span>
    <span class="p">(</span><span class="n">h2</span><span class="p">,</span> <span class="n">w2</span><span class="p">)</span> <span class="o">=</span> <span class="n">img2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">woff</span><span class="p">,</span> <span class="n">hoff</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="n">vert_wh</span>  <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">),</span> <span class="n">h1</span> <span class="o">+</span> <span class="n">h2</span>
    <span class="n">horiz_wh</span> <span class="o">=</span> <span class="n">w1</span> <span class="o">+</span> <span class="n">w2</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">vert</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c"># Display the orientation with the better (closer to 1) aspect ratio</span>
        <span class="n">vert_ar</span>  <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">vert_wh</span><span class="p">)</span> <span class="o">/</span> <span class="nb">min</span><span class="p">(</span><span class="n">vert_wh</span><span class="p">)</span>
        <span class="n">horiz_ar</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">horiz_wh</span><span class="p">)</span> <span class="o">/</span> <span class="nb">min</span><span class="p">(</span><span class="n">horiz_wh</span><span class="p">)</span>
        <span class="n">vert</span> <span class="o">=</span> <span class="n">vert_ar</span> <span class="o">&lt;</span> <span class="n">horiz_ar</span>
    <span class="k">if</span> <span class="n">vert</span><span class="p">:</span>
        <span class="n">wB</span><span class="p">,</span> <span class="n">hB</span> <span class="o">=</span> <span class="n">vert_wh</span>
        <span class="n">hoff</span> <span class="o">=</span> <span class="n">h1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">wB</span><span class="p">,</span> <span class="n">hB</span> <span class="o">=</span> <span class="n">horiz_wh</span>
        <span class="n">woff</span> <span class="o">=</span> <span class="n">w1</span>
    <span class="c"># concatentate images</span>
    <span class="n">dtype</span> <span class="o">=</span> <span class="n">img1</span><span class="o">.</span><span class="n">dtype</span>
    <span class="k">assert</span> <span class="n">img1</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">img2</span><span class="o">.</span><span class="n">dtype</span>
    <span class="k">if</span> <span class="n">nChannels</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">imgB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">hB</span><span class="p">,</span> <span class="n">wB</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="p">)</span>
        <span class="n">imgB</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">h1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">w1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">img1</span>
        <span class="n">imgB</span><span class="p">[</span><span class="n">hoff</span><span class="p">:(</span><span class="n">hoff</span> <span class="o">+</span> <span class="n">h2</span><span class="p">),</span> <span class="n">woff</span><span class="p">:(</span><span class="n">woff</span> <span class="o">+</span> <span class="n">w2</span><span class="p">),</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">img2</span>
    <span class="k">elif</span> <span class="n">nChannels</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">imgB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">hB</span><span class="p">,</span> <span class="n">wB</span><span class="p">),</span> <span class="n">dtype</span><span class="p">)</span>
        <span class="n">imgB</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">h1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">w1</span><span class="p">]</span> <span class="o">=</span> <span class="n">img1</span>
        <span class="n">imgB</span><span class="p">[</span><span class="n">hoff</span><span class="p">:(</span><span class="n">hoff</span> <span class="o">+</span> <span class="n">h2</span><span class="p">),</span> <span class="n">woff</span><span class="p">:(</span><span class="n">woff</span> <span class="o">+</span> <span class="n">w2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">img2</span>
    <span class="k">return</span> <span class="n">imgB</span><span class="p">,</span> <span class="n">woff</span><span class="p">,</span> <span class="n">hoff</span>

</div>
<div class="viewcode-block" id="remove_patches"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.remove_patches">[docs]</a><span class="k">def</span> <span class="nf">remove_patches</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; deletes patches from axes &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">patch</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">patch</span>

</div>
<div class="viewcode-block" id="imshow_null"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.imshow_null">[docs]</a><span class="k">def</span> <span class="nf">imshow_null</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">draw_boxedX</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="axes_bottom_button_bar"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.axes_bottom_button_bar">[docs]</a><span class="k">def</span> <span class="nf">axes_bottom_button_bar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">text_list</span><span class="o">=</span><span class="p">[]):</span>
    <span class="c"># Method 2</span>
    <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">but_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">text_list</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s">&#39;5%&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
        <span class="n">but</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
        <span class="n">ax_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">but_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">but</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">but_list</span><span class="p">,</span> <span class="n">ax_list</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    # Method 1</span>
<span class="sd">    (x1, y1), (x2, y2) = ax.get_position().get_points()</span>
<span class="sd">    # Parent axes props</span>
<span class="sd">    root_left   = x1</span>
<span class="sd">    root_bottom = y1</span>
<span class="sd">    root_height = y2 - y1</span>
<span class="sd">    root_width  = x2 - x1</span>

<span class="sd">    # Build axes for buttons</span>
<span class="sd">    num = len(text_list)</span>
<span class="sd">    pad_percent = .05</span>
<span class="sd">    rect_list = []</span>
<span class="sd">    xpad = root_width * pad_percent</span>
<span class="sd">    width = (root_width - (xpad * num)) / num</span>
<span class="sd">    height = root_height * .05</span>
<span class="sd">    left = root_left</span>
<span class="sd">    bottom = root_bottom - height</span>
<span class="sd">    for ix in range(num):</span>
<span class="sd">        rect = [left, bottom, width, height]</span>
<span class="sd">        rect_list.append(rect)</span>
<span class="sd">        left += width + xpad</span>
<span class="sd">    ax_list = [plt.axes(rect) for rect in rect_list]</span>
<span class="sd">    but_list = [mpl.widgets.Button(ax_, text) for ax_, text in zip(ax_list, text_list)]</span>
<span class="sd">    return but_list</span>
<span class="sd">    &quot;&quot;&quot;</span>

</div>
<div class="viewcode-block" id="make_bbox_positioners"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.make_bbox_positioners">[docs]</a><span class="k">def</span> <span class="nf">make_bbox_positioners</span><span class="p">(</span><span class="n">y</span><span class="o">=.</span><span class="mo">02</span><span class="p">,</span> <span class="n">w</span><span class="o">=.</span><span class="mi">08</span><span class="p">,</span> <span class="n">h</span><span class="o">=.</span><span class="mo">02</span><span class="p">,</span> <span class="n">xpad</span><span class="o">=.</span><span class="mo">05</span><span class="p">,</span> <span class="n">startx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stopx</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">hl_slot</span><span class="p">(</span><span class="n">ix</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">startx</span> <span class="o">+</span> <span class="p">(</span><span class="n">xpad</span> <span class="o">*</span> <span class="p">(</span><span class="n">ix</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">ix</span> <span class="o">*</span> <span class="n">w</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">hr_slot</span><span class="p">(</span><span class="n">ix</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">stopx</span> <span class="o">-</span> <span class="p">((</span><span class="n">xpad</span> <span class="o">*</span> <span class="p">(</span><span class="n">ix</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">ix</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">w</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hl_slot</span><span class="p">,</span> <span class="n">hr_slot</span>

</div>
<div class="viewcode-block" id="width_from"><a class="viewcode-back" href="../../plottool.html#plottool.draw_func2.width_from">[docs]</a><span class="k">def</span> <span class="nf">width_from</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">pad</span><span class="o">=.</span><span class="mo">05</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">stop</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">-</span> <span class="p">((</span><span class="n">num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">pad</span><span class="p">))</span> <span class="o">/</span> <span class="n">num</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">plottool 1.0.0.dev1 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li>
          <li><a href="../plottool.html" >plottool</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Jon Crall.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>